{% extends "base.html" %}
{% block title %}Change Password{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-md-5">

    <div class="card shadow-sm">
      <div class="card-body">

        <h5 class="card-title mb-3">Change Your Password</h5>

        <div class="alert alert-warning">
          You must change your password before continuing.
        </div>

        <!-- Password Rules -->
        <div class="mb-3">
          <small class="text-muted">Password must contain:</small>
          <ul class="small">
            <li id="rule-length" class="text-danger">At least 8 characters</li>
            <li id="rule-upper" class="text-danger">One uppercase letter</li>
            <li id="rule-lower" class="text-danger">One lowercase letter</li>
            <li id="rule-number" class="text-danger">One number</li>
            <li id="rule-special" class="text-danger">One special character</li>
          </ul>
        </div>

        <form method="POST">

          <div class="mb-3">
            <label class="form-label">New Password</label>
            <input type="password"
                   name="password"
                   id="password"
                   class="form-control"
                   required
                   onkeyup="checkPassword()">
          </div>

          <div class="mb-3">
            <label class="form-label">Confirm Password</label>
            <input type="password"
                   name="confirm_password"
                   class="form-control"
                   required>
          </div>

          <button class="btn btn-primary w-100">
            Update Password
          </button>

        </form>

      </div>
    </div>

  </div>
</div>

<script>
function checkPassword() {
  const pwd = document.getElementById("password").value;

  toggle("rule-length", pwd.length >= 8);
  toggle("rule-upper", /[A-Z]/.test(pwd));
  toggle("rule-lower", /[a-z]/.test(pwd));
  toggle("rule-number", /[0-9]/.test(pwd));
  toggle("rule-special", /[^A-Za-z0-9]/.test(pwd));
}

function toggle(id, valid) {
  const el = document.getElementById(id);
  el.classList.remove("text-danger", "text-success");
  el.classList.add(valid ? "text-success" : "text-danger");
}
</script>

{% endblock %}
